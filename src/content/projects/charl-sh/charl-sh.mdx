---
title: charl.sh
link:
  url: https://github.com/aczw/personal-website
  text: Source on GitHub
blurb: How meta! Personal website built with Astro. You're currently looking at it :)
date: 2023-11-15
cover:
  img: ./charl-sh.png
  alt: Image depicts this website's homepage.
tags:
  - Astro
  - TypeScript
  - Tailwind
  - Figma
order: 6
draft: false
slug: www
---

import Img from "@/components/img.astro";

import Link from "@/components/link.astro";

I've always wanted a personal site. I could set it up to showcase and talk about projects I've done (like this one). As a college student, it's nice to be able to directly link to stuff I want to show off. It also felt cool to have a part of the internet that I could call my own.

When I started becoming interested in web dev, I knew what my first project would be: to create my own site. Luckily, it all worked out in the end. Welcome! ♪(´▽｀)

This write-up explains a bit of my thought process behind the design and layout of this site, as well as how previous iterations of the site have helped shape it to what it is now today.

## aczw.dev

You're currently looking at `v3` of my site. `v1` was hosted on an entirely different URL at `aczw.dev` and looked like this:

<Img src={ import("./aczw-dev.png") } alt="Screenshot of the first version of my website. Colors a bit brighter and everything is much, much bigger." />

`v1` is still live at <Link href="https://old.charl.sh" newTab>old.charl.sh</Link>. Why am I still keeping it alive? I dunno, I'm still attached to it. It has sentimental value. A lot of design elements carried over to both `v2` and `v3`.

There were two main reasons I wanted to start over. The first is that I simply didn't like the design. I had sketched out a few ideas beforehand in Procreate and Figma, but I realized the proportions were way off. Why is the text so gigantic?? I started to dislike the color palette.

The layout also started making less sense. The sticky sidebar achieved its goal of displaying my resume and socials, but it really didn't need that much *space*. The card system on the right felt restricting as well. What if I wanted some content that couldn't neatly fit?

The second reason is the tech stack I used. I had recently stumbled upon <Link href="https://twitter.com/t3dotgg" newTab>Theo</Link> and decided to use <Link href="https://create.t3.gg" newTab>Create T3 App</Link> to jumpstart my site. I realize now it did not fit my needs *at all*. I was only using Next.js and Tailwind, completely ignoring its helpful integrations with tRPC, Prisma, and Auth.js.

If I only wanted Next.js, I should've used `create-next-app`. But even Next.js felt overkill for my use case. I wanted something simpler; I'm not building a full-stack app! I also preferred to not leave behind the React knowledge I had just picked up. So I started looking for something different...

## Why Astro

<Link href="https://astro.build/" newTab>Astro</Link> advertises itself as a framework that focuses on content-first sites. That immediately interested me. The more I read, the more I was convinced. It delivered exactly what I had in mind:

- Reusable components that look like vanilla HTML, but with JSX-like syntax
- First-class support for Markdown as well as intriguing stuff like MDX
- Integrations with UI frameworks like React, allowing me to create self-contained <Link href="https://docs.astro.build/en/concepts/islands/" newTab>islands</Link> of interactivity, while keeping everything else static
- Statically generated pages by default, with SSR as an option

I needed nothing more, nothing less. While I could have stuck with Next.js, I liked Astro's streamlined approach more. It felt like it was designed exactly for what I wanted to do. So, Astro it is! 

## A completely new start

I've finished deciding on what to build my new site with. Now I need to tackle the second issue: the new design of the site.

<Img src={ import("./v2-figma.png") } alt="A Figma file containing many different iterations of what my site could look like." />

I played with a number of variations on layout and text placement. Going in I was heavily inspired by Google's <Link href="https://m3.material.io/" newTab>Material You</Link> design language, with its colors, odd shapes, and large rounded corners. From `v1`, I wanted to keep the purple color scheme, primary font, and buttons.

<Img src={ import("./color-palette.png") } alt="The new purple color palette, now in 10 different shades. There also exists a green palette." />

The original color palette had six shades. As I was building `v1`, I felt severely limited by the few choices I had. Therefore I expanded it to a range of 10 values for more variation. I made a green version too.

The final result looked like this:

<Img src={ import("./v2.png") } alt="The new homescreen, with information contained in rounded blocks." className="border-2 border-sweater-9" />

<Img src={ import("./v2-projects.png") } alt="The projects page, with images arranged in a grid and tags displayed underneath visually." className="border-2 border-sweater-9" />

<Img src={ import("./v2-portfolio.png") } alt="The portfolio page, with pieces displayed in columns and separated into different sections." className="border-2 border-sweater-9" />

These are `/`, `/projects`, and `/portfolio` respectively.

I was really satisfied with how it turned out. I absolutely loved the new shades of purple I picked. I incorporated live data from my music habits on the home page, which is nice because music is a big part of my life. I love the footer with the scrolling text. I love how much simpler, cleaner, and more organized it looked compared to `v1`. I love how my projects and portfolio now live on separate pages and are given more room to breathe.

...so why did I decide to restart *again*?

### The bad

To fetch my latest music stats, I make requests to the Last.fm API using my API key. However, the way I did it was *extremely* insecure. While most components were pure Astro, I used React and <Link href="https://swr.vercel.app/" newTab>SWR</Link> for this purpose. SWR needed access to my API key on the client, so... I made it available <Link href="https://docs.astro.build/en/guides/environment-variables/#getting-environment-variables" newTab>by prefixing it</Link> with `PUBLIC_`. Theoretically, anyone visiting my site could have CTRL+F'd it! This is more of a principle thing than anything; I wasn't seriously expecting anyone to steal my API key and use it. Still, it wasn't *good*.

Related to this is that I wasn't too happy with pulling in an entire UI framework and fetching library just to display my most recently listened to music. Astro had to send all of this unnecessary JavaScript to the client, making my site footprint larger than it needs to be. I still prefer using React for large scale projects, but I wanted to start utilizing the built-in Astro features for data fetching.

My final gripe is that the homepage collapses weirdly on smaller screens. I spent a really long time optimizing it, and in the end basically had to redesign for mobile. This meant I had to maintain two completely different designs for no real reason.

So I sat down and rethought my process again. This time, I seeked some more outside help.

## Rethinking what I want

I took inspiration from everywhere. Some ideas came from websites of people I knew, like <Link href="https://www.elyssachou.com/" newTab>elyssachou.com</Link> and <Link href="https://tlshaw.me/" newTab>tlshaw.me</Link>, fellow DMD people. Other ideas came from websites I discovered online, like <Link href="https://www.nexxel.dev/" newTab>nexxel.dev</Link>, <Link href="https://nezu.world/" newTab>nezu.world</Link>, and <Link href="https://paco.me/" newTab>Paco Coursey's site</Link>. Udara Jay's post about <Link href="https://udara.io/reinventing-this-blog" newTab>reinventing their blog</Link> resonated with me.

Looking back now, I realize that with each iteration I stripped away more and more stuff, instead focusing on what I *truly wanted* people to see first.

- Instead of the weird bento box layout for the homepage, I now use a header-content layout. Paragraphs get more room to breathe and I get to display a sneak peek of my projects/posts.
- I still liked the live music updates but deemphasized it, because it wasn't the main reason I directed people to my site. It's mostly for my own enjoyment, anyway.
- The header took up too much space so I made it nonsticky. I don't have that much content to require an always visible nav bar.
- After a slight identity crisis, I decided to combine `/projects` and `/portfolio`. The label "portfolio" didn't make much sense. My programming and design stuff are often one and the same.

I keep everything at a fixed width now (750px, to be exact). I noticed this design choice on the other sites I was ~~stalking~~ *taking inspiration* from. Reading becomes much easier when your eyes don't have to scan across a large horizontal distance.

### Going all in on Astro

Oh, the website is also now 100% written using Astro components. No more React dependency! Along with this I updated the way I fetched data, which is now handled in a much more secure way.

First, I enabled SSR for my homepage, the place where the results of the data fetching are shown. Since the HTML is now rendered on-demand instead of at build time, I can fetch data in the <Link href="https://docs.astro.build/en/core-concepts/astro-components/#the-component-script" newTab>component script</Link> to get the latest information. I also made it a separate component to take advantage of <Link href="https://docs.astro.build/en/guides/server-side-rendering/#html-streaming" newTab>streaming</Link>.

Basically, my `<LastFm />` component looks like this:

```astro
---
import { getRecentTracks } from "@/utils/lastfm";

const recentTracks = await getRecentTracks();
const firstTrack = recentTracks.track[0];
---

<p class="...">The last song I listened to was {firstTrack.name}!</p>
```

I use Zod to verify and parse the data I get back from Last.fm, so I get some nice guarantees as well as type safety. The best part is that my `lastfm.ts` file looks like this:

```ts
const key = import.meta.env.LASTFM_API_KEY;
const url = `https://apiurl.com/?api_key=${key}`;

// my schema goes in here
const recentTracksSchema = z.promise(...);

const getRecentTracks = async () => {
  const data = await recentTracksSchema.parse(
    fetch(url).then((res) => res.json()),
  );

  return data.recenttracks;
};

export { getRecentTracks };
```

You can find <Link href="https://github.com/aczw/personal-website/blob/main/src/components/lastfm.astro" newTab>`lastfm.astro` here</Link> and <Link href="https://github.com/aczw/personal-website/blob/main/src/utils/lastfm.ts" newTab>`lastfm.ts` here</Link>.

My `LASTFM_API_KEY` never leaves the server, because this code is only run on the server. While SWR provided some nice features like refetching on window focus, I don't miss it when compared to this. I make a simple native fetch call and that's it!

Astro makes all of this possible. I haven't even talked about <Link href="https://docs.astro.build/en/guides/content-collections/" newTab>Content Collections</Link>, which is Astro's solution for managing and querying the content you write. The current page you're looking at exists as a MDX file in the specialized `content/` directory, and is rendered to HTML automatically.

Clearly, I really like Astro. I made the choice to switch in `v2` and haven't looked back.

## Conclusion

`aczw.dev` was started in the early summer of 2023. As of writing, it's now mid-November. My site has changed *a lot* in these past five months, and I've learned a lot about web dev as well as myself. `v1` to `v2` was a giant jump, while `v2` to `v3` was a more quiet, refined redesign. I don't think there will be any more large changes from here on out; I'm pretty happy with what I have.

Nailing what you want on the first try is very difficult. It's what you learn along the way that will eventually guide you to something that you're finally satisfied with. I've had a lot of fun designing and redesigning the site, and don't regret making either `v1` or `v2`. They helped me get to `v3` after all.

Thanks for reading. Lemme know what you think about the website.

## Colophon

This site was built with Astro and uses no external UI frameworks. It's styled using Tailwind, with a few `<style>` tags here and there. It's currently deployed on Vercel's free plan, but uses Cloudflare DNS. All the prototyping was done in Procreate and Figma.

Primary type is <Link href="https://en.wikipedia.org/wiki/Atkinson_Hyperlegible" newTab>Atkinson Hyperlegible</Link>. Code is written in <Link href="https://github.com/subframe7536/Maple-font" newTab>Maple Mono</Link>. Icons are from <Link href="https://lucide.dev/" newTab>Lucide</Link>.